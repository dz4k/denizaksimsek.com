<!doctype html>
<html lang="<%= it.lang ?? "en" %>">
<head>
<%~ await includeFile("header.html", it) %>
<!-- Social embeds -->
<meta property="og:title" content="<%= it.title %>">
<meta property="og:url" content="<%= it.url %>">
<meta property="og:type" content="article">
<% if (it.photo) { %>
    <meta property="og:image" content="<%= it.photo.src %>">
<% } %>
<meta name="twitter:card" content="<%= it.photo ? 'summary_large_image' : 'summary' %>">
<meta name="twitter:site" content=@DenizAksimsek>
<meta name="twitter:creator" content=@DenizAksimsek> 

</head>
<body>
<nav class="container">
    <p><a href="/">&larr; <%= intl["Home"][lang] %> </a></p>
</nav>
<article class="container h-entry">
    <header>
        <% if ("title" in it) { %>
            <h1 class="p-name"><%= it.title %></h1>
        <% } %>
        <p>
            <% repeat(tags, (tag, loop) => { %>
                <a href="/tag/<%= tag %>"><data class="p-category" value="<% tag %>">
                    <%= intl[tag + " (tag)"][lang] %></data></a><%~ loop.last ? " &middot; " : ", " %> 
            <% }) %>

            <time class="dt-published" datetime="<%= filters.date(it.date, "ATOM") %>">
                <%~ filters.date(it.date, "M_DATE") %></time>
            
            <%_ if ("last modified" in it) { _%>
                , <em><%= intl["last modified"][it.lang] %></em>
                <time class="dt-last-modified" datetime="<%= filters.date(it["last modified"], "ATOM") %>">
                    <%= filters.date(it["last modified"], "M_DATETIME") %></time> 
            <% } %>
        </p>
        <% for (const prop of ["repost of", "like of"]) { %>
            <% if (prop in it) { %>
                <p>
                    <a class="u-<%= prop.replace(" ", "-") %>" href="<%= it[prop].url %>">
                        <%= it[prop].name %>
                    </a>
                </p>
            <% } %>
        <% } %>

        </dl>        
        <% if ("..." in it) { %>
            <p><%~ it["..."] %></p>
        <% } %>
    </header>

    <% if ("bookmark of" in it) { %>
        <missing-card class="crowded" onclick="this.querySelector('a').click()">
            <p>
                &rarr;
                <a class="u-bookmark-of" href="<%= it["bookmark of"].url %>">
                    <%= it["bookmark of"].name %>
                </a>
            </p>
        </missing-card>
    <% } %>
    
    <div class="e-content">
        <%~ it.content %>
    </div>
    
    <footer class="missing-card">
        <% if ("syndication" in it) { %>
                <p>
                    <strong><%= intl["Elsewhere"][lang] %>:</strong> 
                    <% repeat(Object.keys(it.syndication), (syn, loop) => { %>
                        <a rel="syndication" href="<%= it.syndication[syn] %>">
                            <%= syn %></a><%= loop.last ? "" : ", " %> 
                    <% }) %>
                </p>
        <% } %>

        <% if (url in webmentions) { %>
            <section id="interactions">
                <% for (const prop of ["repost-of", "like-of"]) { %>
                    <% if (prop in webmentions[url]) { %>
                        <p class="list-of-links">
                            <strong><%= intl[prop + " (reflexive)"][lang] %>:</strong>
                            <% const wms = webmentions[url][prop] %>
                            <% for (let i = 0; i < wms.length; i++) { %>
                                <a href="<%= wms[i].url %>"><%= wms[i].author.name %></a><%
                                = i === wms.length-1 ? "" : ", " %>
                            <% } %>
                        </p>
                    <% } %>
                <% }%>
        <% } %>
    </footer>
</article>
<%~ await includeFile("footer.html") %>
</body>
